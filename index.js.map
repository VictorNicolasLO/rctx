{"version":3,"file":"index.js","sources":["src/lib/combineContexts.js","src/lib/ContextComponent.js","src/lib/ContextStore.js","src/lib/createContext.js","src/lib/importContexts.js","src/lib/injectContexts.js"],"sourcesContent":["import React, { Component } from 'react';\n\nexport const combineContexts = contextList => {\n  class MainContextComponent extends Component {\n    constructor(props) {\n      super(props);\n      this.mergedContexts = this.buildContexts(contextList);\n    }\n\n    buildContexts(contexts, data = {}, i = 0) {\n      if (contexts[i]) {\n        const ContextComponent = contexts[i].CtxComponent;\n        const result = (\n          <ContextComponent>\n            {this.buildContexts(contexts, data, i + 1)}\n          </ContextComponent>\n        );\n        return result;\n      } else {\n        const result = this.props.children;\n        return result;\n      }\n    }\n\n    render() {\n      return this.mergedContexts;\n    }\n  }\n  return MainContextComponent;\n};\n","import React, { Component } from 'react';\n\nexport class ContextComponent extends Component {\n  Context = undefined;\n  store = undefined;\n  constructor(props) {\n    super(props);\n    console.log('contectComponent initialized');\n  }\n\n  render() {\n    if (!this.Context) {\n      return '';\n    }\n    return (\n      <this.Context.Provider value={this.state}>\n        {this.props.children}\n      </this.Context.Provider>\n    );\n  }\n}\n","export class ContextStore {\n  constructor(defaultData) {\n    if (defaultData) this.data = defaultData;\n  }\n  set(data, key) {\n    if (!this.data[key]) {\n      this.data[key] = {};\n    }\n    this.data[key] = { ...this.data[key], ...data };\n  }\n  get(key) {\n    if (!this.data[key]) {\n      this.data[key] = {};\n    }\n    return this.data[key];\n  }\n  data = {};\n}\n","import React, { Children } from 'react';\n\nexport function createContext(ContextComponent, options = {}) {\n  const { store } = options;\n\n  let context = React.createContext({});\n  class NewCtx extends ContextComponent {\n    constructor(props) {\n      super(props);\n      this.store = store;\n      if (this.store) {\n        console.log(props.children.props.contextKey);\n        const store = this.store.get(props.children.props.contextKey);\n        this.contextKey = props.contextKey;\n        this.state = {\n          ...this.state,\n          ...store,\n          ...this\n        };\n      } else\n        this.state = {\n          ...this.state,\n          ...this\n        };\n    }\n\n    componentWillUnmount() {\n      if (this.store) {\n        this.store.set(this.state, this.props.children.props.contextKey);\n      }\n    }\n\n    store = store;\n    Context = context;\n  }\n\n  return { context, CtxComponent: NewCtx };\n}\n","import { combineContexts } from './combineContexts';\nimport React from 'react';\nexport const importContexts = (Component, contexts) => {\n  const MainContextComponent = combineContexts(contexts);\n  const ComponentWithContexts = props => {\n    return (\n      <MainContextComponent>\n        <Component {...props} />\n      </MainContextComponent>\n    );\n  };\n  return ComponentWithContexts;\n};\n","import React, { Component } from 'react';\n\nconst createRender = (\n  contexts,\n  contextNames,\n  Component,\n  props,\n  data = {},\n  i = 0\n) => {\n  if (contextNames[i]) {\n    const name = contextNames[i];\n    const ContextConsumer = contexts[name].context.Consumer;\n    return (\n      <ContextConsumer>\n        {value => {\n          data[name] = value;\n          return createRender(\n            contexts,\n            contextNames,\n            Component,\n            props,\n            data,\n            i + 1\n          );\n        }}\n      </ContextConsumer>\n    );\n  } else {\n    return <Component {...data} {...props} />;\n  }\n};\n\nexport const injectContexts = (Component, contexts) => {\n  const contextNames = Object.keys(contexts);\n\n  class WithContextComponent extends React.Component {\n    constructor(props) {\n      super(props);\n      this.renderCreated = createRender(\n        contexts,\n        contextNames,\n        Component,\n        props\n      );\n    }\n    render() {\n      return this.renderCreated;\n    }\n  }\n\n  return WithContextComponent;\n};\n"],"names":["combineContexts","MainContextComponent","props","mergedContexts","buildContexts","contextList","contexts","data","i","ContextComponent","CtxComponent","result","React","children","Component","Context","undefined","store","log","state","ContextStore","defaultData","key","createContext","options","context","NewCtx","contextKey","get","set","importContexts","ComponentWithContexts","createRender","contextNames","name","ContextConsumer","Consumer","value","injectContexts","Object","keys","WithContextComponent","renderCreated"],"mappings":"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"}